<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>voltgamble</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="game-container" class="hidden">
        <div id="money-display">Money: $0.00</div>
        <div id="minesweeper">
            <!-- Minesweeper grid will be inserted here -->
        </div>
        <div id="button-container">
            <button id="start-button" class="action-button">Start Mines</button>
            <button id="cashout-button" class="action-button hidden">Cash Out</button>
        </div>
    </div>
    <script>
        function getUserId() {
            return localStorage.getItem('userId');
        }

        function getUserData() {
            const userId = getUserId();
            if (userId) {
                return JSON.parse(localStorage.getItem('userData'))[userId];
            }
            return null;
        }

        function saveUserData(userData) {
            const userId = getUserId();
            if (userId) {
                let allUserData = JSON.parse(localStorage.getItem('userData')) || {};
                allUserData[userId] = userData;
                localStorage.setItem('userData', JSON.stringify(allUserData));
            }
        }

        function updateBalanceDisplay(balance) {
            document.getElementById('money-display').textContent = `Money: $${balance.toFixed(2)}`;
        }

        function periodicSave() {
            const userData = getUserData();
            if (userData) {
                saveUserData(userData);
            }
        }

        window.addEventListener('beforeunload', () => {
            periodicSave();
        });

        document.addEventListener('DOMContentLoaded', () => {
            const userData = getUserData();
            if (!userData) {
                window.location.href = 'login.html';
                return;
            }

            updateBalanceDisplay(userData.balance);

            const startButton = document.getElementById('start-button');
            const cashoutButton = document.getElementById('cashout-button');

            startButton.addEventListener('click', () => {
                const betAmount = parseInt(document.getElementById('betAmount').value);
                const minesAmount = parseInt(document.getElementById('minesAmount').value);
                if (betAmount > userData.balance || betAmount <= 0 || minesAmount < 1 || minesAmount >= 25) {
                    alert('Invalid bet or mines amount');
                    return;
                }

                userData.balance -= betAmount;
                updateBalanceDisplay(userData.balance);
                saveUserData(userData);

                // Game start logic
                // ...
            });

            cashoutButton.addEventListener('click', () => {
                // Cash out logic
                const betAmount = parseInt(document.getElementById('betAmount').value);
                userData.balance += betAmount; // Example calculation
                updateBalanceDisplay(userData.balance);
                saveUserData(userData);
            });

            // Handle game logic to periodically save balance
            setInterval(() => {
                periodicSave();
            }, 1000); // Save every 1 second
        });
    </script>
</body>
</html>
